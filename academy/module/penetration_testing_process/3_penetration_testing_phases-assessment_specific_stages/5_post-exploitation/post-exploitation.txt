*** Post-Exploitation
Постэксплуатация
	
	- Предположим, мы успешно использовали целевую систему во время
	Exploitationсцена. Как и в случае со стадией эксплуатации, мы снова должны
	решить, использовать ли Evasive Testingв Post-Exploitationсцена. Мы уже
	находимся в системе на этапе пост-эксплуатации, что значительно усложняет
	задачу избежать предупреждения. Post-ExploitationЭтап направлен на получение
	конфиденциальной и важной для безопасности информации с локальной точки
	зрения, а также важной для бизнеса информации, которая в большинстве случаев
	требует более высоких привилегий, чем у обычного пользователя. Этот этап
	включает в себя следующие компоненты:

		Уклончивое тестирование 	Сбор информации
		Мародерство 				Оценка уязвимости
		Повышение привилегий 		Упорство
		Эксфильтрация данных
			
			~~~___ LINK ___~~~ 0-PT-Process-POEX.png	

	### Evasive Testing
	Уклончивое тестирование
		
		Если за системами следит опытный администратор, любое изменение или даже
		одна команда могут вызвать тревогу, которая нас выдаст. Во многих
		случаях нас выкидывают из сети, после чего начинается охота за угрозами
		там, где мы находимся в центре внимания. Мы также можем потерять доступ
		к хосту (который был помещен в карантин) или учетной записи пользователя
		(который был временно отключен или пароль был изменен). Этот тест на
		проникновение был бы неудачным, но в некотором смысле успешным, потому
		что клиент мог обнаружить некоторые действия. Мы можем принести пользу
		клиенту в этой ситуации, описав всю цепочку атаки и помогая ему выявить
		пробелы в их мониторинге и процессах, где они не заметили наших
		действий. Для нас мы можем изучить, как и почему клиент нас обнаружил, и
		работать над улучшением наших навыков уклонения. Возможно, мы
		недостаточно тщательно протестировали полезную нагрузку или проявили
		невнимательность и запустили такую команду, как [net user] или
		же [whoami] это часто отслеживается системами EDR и помечается как
		аномальная активность.
			
			... Примечание ...  
								Нашим клиентам часто может помочь, если мы
			запускаем команды или инструменты, которые их средства защиты
			останавливают или обнаруживают. Это показывает им, что их защита
			работает над некоторыми атаками. Имейте в виду, что мы эмулируем
			злоумышленника, поэтому не всегда плохо, если некоторые атаки будут
			замечены. Хотя при проведении скрытого тестирования наша цель должна
			заключаться в том, чтобы оставаться незамеченными, чтобы мы могли
			выявить любые «слепые зоны», которые есть у наших клиентов в их
			сетевых средах. 

		Уклоняющее тестирование делится на три категории:
		
		_ Evasive 	_Hybrid Evasive 	_Non-Evasive

		Это не означает, что мы не можем использовать все три метода.
		Предположим, наш клиент хочет провести навязчивый тест на проникновение,
		чтобы получить как можно больше информации и наиболее подробные
		результаты тестирования. В таком случае мы будем выполнять
		Non-EvasiveТестирование, так как меры безопасности в сети могут
		ограничить и даже остановить нас. Однако это также может сочетаться с
		Evasiveтестирование с использованием тех же команд и методов для
		неуклонного тестирования. Затем мы можем увидеть, могут ли меры
		безопасности идентифицировать выполняемые действия и реагировать на них.
		В Hybrid-Evasiveтестирование, мы можем протестировать определенные
		компоненты и меры безопасности, которые были определены заранее. Это
		обычное дело, когда клиент хочет протестировать только определенные
		отделы или серверы, чтобы увидеть, могут ли они противостоять атакам. 

	### Information Gathering
	Сбор информации
		
		- Поскольку мы получили новый взгляд на систему и сеть нашей целевой
		системы на этапе эксплуатации, мы находимся в основном в новой среде.
		Это означает, что сначала мы должны заново ознакомиться с тем, с чем мы
		работаем и какие варианты доступны. Следовательно, в
		Post-Exploitationэтап, мы проходим через Information Gatheringа также
		Vulnerability Assessmentснова этапы, которые мы можем рассматривать как
		части текущего этапа. Это потому, что информация, которую мы имели до
		этого момента, была собрана с внешней точки зрения, а не с внутренней.

		С внутренней (местной) точки зрения у нас есть гораздо больше
		возможностей и альтернатив для доступа к определенной информации,
		которая имеет отношение к нам. Поэтому этап сбора информации начинается
		заново с местной точки зрения. Мы ищем и собираем как можно больше
		информации. Разница здесь в том, что мы также перечисляем локальную сеть
		и локальные службы, такие как принтеры, серверы баз данных, службы
		виртуализации и т. д. Часто мы находим общие ресурсы, предназначенные
		для использования сотрудниками для обмена данными и файлами.
		Исследование этих сервисов и сетевых компонентов называется Pillaging.

	### Pillaging
	мародерство
		
		Мародерство — это этап, на котором мы изучаем роль хоста в корпоративной
		сети. Мы анализируем конфигурации сети, включая, помимо прочего:

			Интерфейсы 		Маршрутизация 		DNS
			ARP 			Услуги 				VPN
			IP-подсети 		Акции 				Сетевой трафик


		Understanding the role of the systemмы также даем нам отличное
		представление о том, как он взаимодействует с другими сетевыми
		устройствами и его цели. Отсюда мы можем узнать, например, какие
		существуют альтернативные поддомены, имеет ли он несколько сетевых
		интерфейсов, есть ли другие хосты, с которыми общается эта система,
		подключаются ли с нее админы к другим хостам и можем ли мы потенциально
		повторно использовать учетные данные или украсть ключ SSH, чтобы
		расширить наш доступ или установить постоянство и т. д. Это помогает,
		прежде всего, получить обзор структуры сети.

		Например, мы можем использовать политики, установленные в этой системе,
		чтобы определить, что другие хосты используют в сети. Потому что
		администраторы часто используют определенные схемы для защиты своей сети
		и не позволяют пользователям что-либо в ней менять. Например,
		предположим, мы обнаружили, что политика паролей требует только восьми
		символов, но не специальных символов. В этом случае мы можем сделать
		вывод, что у нас относительно высокая вероятность подбора паролей других
		пользователей в этой и других системах.

		На этапе мародерства мы также будем охотиться за конфиденциальными
		данными, такими как пароли к общим ресурсам, локальным компьютерам, в
		скриптах, файлах конфигурации, хранилищах паролей, документах (файлы
		Excel, Word, .txt и т. д.) и даже электронной почте.

		Наши основные цели при разграблении — показать влияние успешной
		эксплуатации и, если мы еще не достигли цели оценки, найти
		дополнительные данные, такие как пароли, которые могут быть входными
		данными для других этапов, таких как боковое перемещение. 

	### Persistence
	Упорство
		
		Как только мы получим обзор системы, нашим непосредственным следующим
		шагом будет сохранение доступа к эксплуатируемому хосту. Таким образом,
		если соединение прервется, мы все равно сможем получить к нему доступ.
		Этот шаг является важным и часто используется в качестве первого шага
		перед Information Gatheringа также Pillagingэтапы.

		Мы должны следовать нестандартным последовательностям, потому что каждая
		система индивидуально настраивается уникальным администратором, который
		привносит свои предпочтения и знания. Рекомендуется, чтобы мы work
		flexiblyна этом этапе and adaptк обстоятельствам. Например, предположим,
		что мы использовали атаку переполнения буфера на службу, которая может
		привести к ее сбою. В этом случае мы должны установить постоянство в
		системе как можно скорее, чтобы избежать многократных атак на службу и
		возможных сбоев. Часто, если мы потеряем соединение, мы не сможем
		получить доступ к системе таким же образом.


	### Privilege Escalation
	Повышение привилегий
		
		Повышение привилегий имеет большое значение, и в большинстве случаев оно
		представляет собой критический момент, который может открыть для нас еще
		много новых дверей. Получение максимально возможных привилегий в системе
		или домене часто имеет решающее значение. Поэтому мы хотим получить
		привилегии root(на Linux-basedсистемы) или домен administrator/ local
		administrator/ SYSTEM(на Windows-basedсистемы), потому что это часто
		позволит нам перемещаться по всей сети без каких-либо ограничений.

		Однако важно помнить, что повышение привилегий не всегда должно
		происходить локально в системе. Мы также можем получить сохраненные
		учетные данные на этапе сбора информации от других пользователей,
		которые являются членами группы с более высоким уровнем привилегий.
		Использование этих привилегий для входа в систему под другим
		пользователем также является частью повышения привилегий, поскольку мы
		повысили наши привилегии (быстро), используя новый набор учетных данных. 

	### Data Exfiltration
	Эксфильтрация данных
		
		В течение Information Gatheringа также Pillagingэтапе мы часто сможем
		найти, среди прочего, значительную личную информацию и данные клиентов.
		Некоторые клиенты захотят проверить, можно ли эксфильтровать эти типы
		данных. Это означает, что мы пытаемся передать эту информацию из целевой
		системы в нашу собственную. Системы безопасности, такие как Data Loss
		Prevention( DLP) а также Endpoint Detection and Response( EDR) помогает
		обнаруживать и предотвращать утечку данных. В дополнение к Network
		Monitoring, многие компании используют шифрование на жестких дисках,
		чтобы предотвратить просмотр такой информации посторонними лицами.
		Прежде чем эксфильтровать какие-либо фактические данные, мы должны
		проконсультироваться с заказчиком и нашим менеджером. Часто бывает
		достаточно создать некоторые поддельные данные (например, поддельные
		номера кредитных карт или номера социального страхования) и внедрить их
		в нашу систему. Таким образом, механизмы защиты, которые ищут шаблоны в
		данных, покидающих сеть, будут проверены, но мы не будем нести
		ответственность за какие-либо конфиденциальные данные в реальном времени
		на нашей тестовой машине.

		Компании должны соблюдать правила безопасности данных в зависимости от
		типа данных. К ним относятся, но не ограничиваются:

		
			Тип информации 								Правила безопасности
			
			Информация о счете кредитной карты 			Payment Card Industry( PCI)
			Электронная информация о здоровье пациента 	Health Insurance Portability and Accountability Act( HIPAA)
			Потребители Private Banking Информация 		Gramm-Leach-Bliley( GLBA)
			Правительственная информация 				Federal Information Security Management Act of 2002( FISMA) 

		Некоторые фреймворки компании могут следовать включают:

		( NIST) - Национальный институт стандартов и технологий 				
		( CIS Controls) - Центр контроля интернет-безопасности
		( ISO) - Международная организация по стандартизации 
		( PCI-DSS) - Стандарт безопасности данных индустрии платежных карт
		( GDPR) - Общее положение о защите данных 								
		( COBIT) - Цели управления для информационных и связанных с ними технологий
		( FedRAMP) - Федеральная программа управления рисками и авторизацией 	
		( ITAR) - Правила международной торговли оружием
		( AICPA) - Американский институт дипломированных бухгалтеров 			
		( NERC CIP Standards) - Стандарты защиты критической инфраструктуры NERC


		- Стоит ознакомиться с каждым из этих фреймворков, но для нас крайне важно
		то, как мы обращаемся с этой информацией. Для нас тип данных не имеет
		большого значения, но необходимый контроль над ним имеет значение, и,
		как указывалось ранее, мы можем имитировать эксфильтрацию данных из сети
		в качестве доказательства того, что это возможно. Мы должны проверить у
		клиента, чтобы убедиться, что его системы предназначены для обнаружения
		поддельного типа данных, который мы пытаемся эксфильтровать в случае
		успеха, поэтому мы ничего не искажаем в нашем отчете.

		Это хорошая привычка запускать запись экрана (наряду со скриншотами) в
		качестве дополнительного доказательства таких важных шагов. Если у нас
		есть только терминальный доступ, мы можем отобразить имя хоста,
		IP-адрес, имя пользователя и соответствующий путь к файлу клиента и
		сделать снимок экрана или снимок экрана. Это помогает нам доказать,
		откуда взялись данные и что мы можем успешно удалить их из среды.

		Если такие конфиденциальные данные будут обнаружены, наш клиент, конечно
		же, должен быть немедленно проинформирован. Основываясь на том факте,
		что мы можем повысить привилегии и вывести личные данные, они могут
		захотеть приостановить, завершить или сместить фокус теста на
		проникновение, особенно если основной целью была эксфильтрация данных.
		Однако это остается на усмотрение нашего клиента, и многие предпочтут,
		чтобы мы продолжили тестирование, чтобы выявить все возможные слабые
		места в их среде.

		Далее мы обсудим боковое движение, ключевой этап процесса тестирования
		на проникновение, который может использовать данные нашей
		пост-эксплуатации в качестве входных данных.





	

