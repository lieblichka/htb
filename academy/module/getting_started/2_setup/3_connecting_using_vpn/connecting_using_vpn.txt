*** Connecting Using VPN
Подключение через VPN 
	
	Виртуальная частная сеть (VPN)
		
		 https://en.wikipedia.org/wiki/Virtual_private_network

	Позволяет нам подключаться к частной (внутренней) сети и получать доступ к
	хостам и ресурсам, как если бы мы были напрямую подключены к целевой частной
	сети. Это защищенный канал связи через общие общедоступные сети для
	подключения к частной сети (т. е. сотрудник, удаленно подключающийся к
	корпоративной сети своей компании из своего дома). Виртуальные частные сети
	обеспечивают определенную степень конфиденциальности и безопасности, шифруя
	сообщения по каналу, чтобы предотвратить прослушивание и доступ к данным,
	проходящим по каналу.
		
		~~~___ LINK ___~~~ img/GettingStarted.png

	На высоком уровне VPN работает путем маршрутизации интернет-соединения
	нашего подключаемого устройства через частный сервер целевого VPN, а не
	через нашего интернет-провайдера (ISP). При подключении к VPN данные
	поступают с сервера VPN, а не с нашего компьютера, и будет казаться, что они
	исходят с общедоступного IP-адреса, отличного от нашего собственного.

	Существует два основных типа VPN удаленного доступа: клиентская VPN и SSL
	VPN. SSL VPN использует веб-браузер в качестве клиента VPN. Соединение
	устанавливается между браузером и шлюзом SSL VPN, который можно настроить
	так, чтобы разрешить доступ только к веб-приложениям, таким как электронная
	почта и сайты интрасети, или даже к внутренней сети, но без необходимости
	для конечного пользователя устанавливать или использовать какие-либо
	специализированные программного обеспечения. Клиентская VPN требует
	использования клиентского программного обеспечения для установки
	VPN-подключения. После подключения хост пользователя будет работать в
	основном так, как если бы он был подключен непосредственно к сети компании,
	и сможет получить доступ к любым ресурсам (приложениям, хостам, подсетям и
	т. д.), разрешенным конфигурацией сервера. Некоторые корпоративные VPN
	предоставят сотрудникам полный доступ к внутренней корпоративной сети, а
	другие поместят пользователей в определенный сегмент, зарезервированный для
	удаленных работников. 
	
	### Why Use A VPN?
	Зачем использовать VPN? 
		
		- Мы можем использовать службу VPN, такую как NordVPNили же Private
		Internet Accessи подключиться к VPN-серверу в другой части нашей страны
		или другого региона мира, чтобы скрыть наш трафик просмотра или
		замаскировать наш общедоступный IP-адрес. Это может обеспечить нам
		некоторый уровень безопасности и конфиденциальности. Тем не менее,
		поскольку мы подключаемся к серверу компании, всегда есть вероятность,
		что данные регистрируются или служба VPN не следует передовым методам
		безопасности или функциям безопасности, которые они рекламируют.
		Использование службы VPN сопряжено с риском того, что провайдер не
		делает то, что говорит, и регистрирует все данные. Использование службы
		VPN не гарантирует анонимность или конфиденциальность, но полезно для
		обхода определенных ограничений сети/брандмауэра или при подключении к
		возможной враждебной сети (например, общедоступной беспроводной сети
		аэропорта). Служба VPN никогда не должна использоваться с мыслью, что
		она защитит нас от последствий совершения гнусных действий.

	### Connecting to HTB VPN
	Подключение к HTBVPN
		
		- HTB и другие сервисы, предлагающие намеренно уязвимые виртуальные
		машины/сети, требуют от игроков подключения к целевой сети через VPN для
		доступа к сети частной лаборатории. Хосты в сетях HTB не могут напрямую
		подключаться к Интернету. При подключении к HTB VPN (или любой
		лаборатории, специализирующейся на тестировании на проникновение или
		взломе) мы всегда должны считать сеть «враждебной». Мы должны
		подключаться только с виртуальной машины, запрещать аутентификацию по
		паролю, если SSH включен на нашей атакующей ВМ, блокировать все
		веб-серверы и не оставлять конфиденциальную информацию на нашей
		атакующей ВМ (т. е. не играть в HTB или другие уязвимые сети с той же
		ВМ). которые мы используем для оценки клиентов). При подключении к VPN
		(либо в HTB Academy, либо на основной платформе HTB) мы подключаемся с
		помощью следующей команды:
			
			~ mwuckert@htb[/htb]$ sudo openvpn user.ovpn
				

				Thu Dec 10 18:42:41 2020 OpenVPN 2.4.9 x86_64-pc-linux-gnu [SSL (OpenSSL)] [LZO] [LZ4] [EPOLL] [PKCS11] [MH/PKTINFO] [AEAD] built on Apr 21 2020
				Thu Dec 10 18:42:41 2020 library versions: OpenSSL 1.1.1g  21 Apr 2020, LZO 2.10
				Thu Dec 10 18:42:41 2020 Outgoing Control Channel Authentication: Using 256 bit message hash 'SHA256' for HMAC authentication
				Thu Dec 10 18:42:41 2020 Incoming Control Channel Authentication: Using 256 bit message hash 'SHA256' for HMAC authentication
				Thu Dec 10 18:42:41 2020 TCP/UDP: Preserving recently used remote address: [AF_INET]
				Thu Dec 10 18:42:41 2020 Socket Buffers: R=[212992->212992] S=[212992->212992]
				Thu Dec 10 18:42:41 2020 UDP link local: (not bound)
				<SNIP>
				Thu Dec 10 18:42:41 2020 Initialization Sequence Completed

				# Последняя строка Initialization Sequence Completedговорит нам,
				что мы успешно подключились к VPN.

		Где sudoговорит нашему хосту запустить команду от имени пользователя
		root с повышенными правами, openvpnявляется VPN-клиентом, а
		user.ovpnфайл — это ключ VPN, который мы загружаем либо из раздела
		модуля Академии, либо с главной страницы доступа 
			
			https://www.hackthebox.eu/home/htb/access

		К платформе HTB . Если
		мы напечатаем ifconfigв другом окне терминала мы увидим tunадаптер, если
		мы успешно подключились к VPN.
			
			~ mwuckert@htb[/htb]$ ifconfig

			<SNIP>

			tun0: flags=4305<UP,POINTOPOINT,RUNNING,NOARP,MULTICAST>  mtu 1500
					inet 10.10.x.2  netmask 255.255.254.0  destination 10.10.x.2
					inet6 dead:beef:1::2000  prefixlen 64  scopeid 0x0<global>
					inet6 fe80::d82f:301a:a94a:8723  prefixlen 64  scopeid 0x20<link>
					unspec 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  txqueuelen

		
		Ввод netstat -rnпокажет нам сети, доступные через VPN
			
			~ mwuckert@htb[/htb]$ netstat -rn

				Kernel IP routing table
				Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
				0.0.0.0         192.168.1.2     0.0.0.0         UG        0 0          0 eth0
				10.10.14.0      0.0.0.0         255.255.254.0   U         0 0          0 tun0
				10.129.0.0      10.10.14.1      255.255.0.0     UG        0 0          0 tun0
				192.168.1.0     0.0.0.0         255.255.255.0   U         0 0          0 eth0
				
				# Здесь видно, что сеть 10.129.0.0/16, используемая для машин HTB
				Academy, доступна через tun0адаптер через сеть 10.10.14.0/23.


	### Help with VPN
	Помогите с ВПН
		
		Если вы впервые используете VPN, вам будут полезны следующие ресурсы на
		портале поддержки Hack The Box:
			

			Введение в лабораторный доступ
				
				https://help.hackthebox.com/en/articles/5185687-gs-introduction-to-lab-access

			Устранение неполадок подключения
				
				https://help.hackthebox.com/en/articles/5185536-t-connection-troubleshooting



